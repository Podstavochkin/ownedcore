# üßπ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ—á–∏—Å—Ç–∫–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–î–∞—Ç–∞:** 29.12.2025

---

## üìä –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è

–ê–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑–∞–ª:
- **485 –∞–∫—Ç–∏–≤–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π** –≤ —Å–∏—Å—Ç–µ–º–µ
- **280 —É—Ä–æ–≤–Ω–µ–π** —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π (57.7%)
- **145 —É—Ä–æ–≤–Ω–µ–π** —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π (29.9%)
- **361 —É—Ä–æ–≤–µ–Ω—å** –¥–∞–ª—å—à–µ 5% –æ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã (74.4%)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–≥–æ —Å—Ç–∞—Ä—ã—Ö —É—Ä–æ–≤–Ω–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∞–∫—Ç—É–∞–ª—å–Ω—ã–º —Å–≤–µ—á–∞–º –∏ –∑–∞—Å–æ—Ä—è—é—Ç —Å–∏—Å—Ç–µ–º—É.

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –£–ª—É—á—à–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `cleanup_outdated_levels()`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –£–≤–µ–ª–∏—á–µ–Ω –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç —Å 48 —á–∞—Å–æ–≤ –¥–æ **7 –¥–Ω–µ–π** (168 —á–∞—Å–æ–≤)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ **—Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –æ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã** (> 5%)
- –¢–µ–ø–µ—Ä—å —É–¥–∞–ª—è–µ—Ç —É—Ä–æ–≤–Ω–∏ –ø–æ 4 –∫—Ä–∏—Ç–µ—Ä–∏—è–º:
  1. –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∫–∞—Å–∞–Ω–∏–π (test_count >= max_live_tests)
  2. –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ (—Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π)
  3. –ü—Ä–æ–±–∏—Ç—ã–µ (—Ü–µ–Ω–∞ –ø—Ä–æ–±–∏–ª–∞ —É—Ä–æ–≤–µ–Ω—å)
  4. **–î–∞–ª–µ–∫–æ –æ—Ç —Ü–µ–Ω—ã (> 5%)** - –ù–û–í–û–ï

**–§–∞–π–ª:** `core/analysis_engine.py` (—Å—Ç—Ä–æ–∫–∞ ~213, ~265)

---

### 2. –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ –æ—á–∏—Å—Ç–∫–∏

**–ù–æ–≤—ã–µ –∑–∞–¥–∞—á–∏:**
- `cleanup-outdated-levels-periodic` - –∫–∞–∂–¥—ã–π —á–∞—Å –æ—á–∏—â–∞–µ—Ç –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏
- `cleanup-old-signals-periodic` - —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏ —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –∑–∞–∫—Ä—ã—Ç—ã–µ —Å–∏–≥–Ω–∞–ª—ã (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)

**–§–∞–π–ª—ã:**
- `tasks/cleanup_tasks.py` - –Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
- `tasks/celery_app.py` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ

---

## üõ†Ô∏è –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –æ—á–∏—Å—Ç–∫–∏

### 1. –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö (–±–µ–∑–æ–ø–∞—Å–Ω—ã–π, —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä)

```bash
python3 scripts/cleanup_old_data.py
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —É—Ä–æ–≤–Ω—è–º
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ (DRY RUN)
- –ù–µ —É–¥–∞–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ

---

### 2. –†–µ–∞–ª—å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```bash
python3 scripts/delete_old_data.py
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –£–¥–∞–ª—è–µ—Ç —Å–∏–≥–Ω–∞–ª—ã –¥–æ 10.12.2024
- –£–¥–∞–ª—è–µ—Ç —É—Ä–æ–≤–Ω–∏ —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π
- –£–¥–∞–ª—è–µ—Ç —É—Ä–æ–≤–Ω–∏ –¥–∞–ª—å—à–µ 5% –æ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã
- **–¢—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è** (yes/no)

**‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï:** –≠—Ç–æ —É–¥–∞–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã! –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è!

---

## üìã –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –®–∞–≥ 1: –ê–Ω–∞–ª–∏–∑ (—É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω)

```bash
python3 scripts/cleanup_old_data.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ù–∞–π–¥–µ–Ω–æ 280 —É—Ä–æ–≤–Ω–µ–π —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π
- –ù–∞–π–¥–µ–Ω–æ 361 —É—Ä–æ–≤–µ–Ω—å –¥–∞–ª—å—à–µ 5% –æ—Ç —Ü–µ–Ω—ã

---

### –®–∞–≥ 2: –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```bash
python3 scripts/delete_old_data.py
```

**–í–≤–µ–¥–∏—Ç–µ:** `yes` –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –£–¥–∞–ª–µ–Ω–æ ~280-361 —Å—Ç–∞—Ä—ã—Ö —É—Ä–æ–≤–Ω–µ–π
- –°–∏—Å—Ç–µ–º–∞ –æ—á–∏—â–µ–Ω–∞ –æ—Ç –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏

```bash
python3 scripts/cleanup_old_data.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—Å—è
- –û—Å—Ç–∞–Ω—É—Ç—Å—è —Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏

---

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞—Ç—å:

1. **–ö–∞–∂–¥—ã–π —á–∞—Å:** –ù–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ (—Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π, –ø—Ä–æ–±–∏—Ç—ã–µ, –¥–∞–ª–µ–∫–æ –æ—Ç —Ü–µ–Ω—ã)
2. **–†–∞–∑ –≤ —Å—É—Ç–∫–∏:** –°—Ç–∞—Ä—ã–µ –∑–∞–∫—Ä—ã—Ç—ã–µ —Å–∏–≥–Ω–∞–ª—ã (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)

**–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ!**

---

## üìä –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É–¥–∞–ª–µ–Ω–∏—è —É—Ä–æ–≤–Ω–µ–π

–£—Ä–æ–≤–µ–Ω—å –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω, –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **—Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ** —É—Å–ª–æ–≤–∏–µ:

1. ‚úÖ **–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∫–∞—Å–∞–Ω–∏–π:** `live_test_count >= max_live_tests` (–æ–±—ã—á–Ω–æ 5)
2. ‚úÖ **–£—Å—Ç–∞—Ä–µ–≤—à–∏–π:** `created_at` —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π
3. ‚úÖ **–ü—Ä–æ–±–∏—Ç—ã–π:** –¶–µ–Ω–∞ –ø—Ä–æ–±–∏–ª–∞ —É—Ä–æ–≤–µ–Ω—å –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 0.5%
4. ‚úÖ **–î–∞–ª–µ–∫–æ –æ—Ç —Ü–µ–Ω—ã:** –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã > 5%

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ –∫–æ–¥:

```python
# –í core/analysis_engine.py, —Ñ—É–Ω–∫—Ü–∏—è cleanup_outdated_levels()
max_age_hours = 168  # 7 –¥–Ω–µ–π (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å)
max_distance_pct = 5.0  # 5% (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å)
```

---

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –≤ –ª–æ–≥–∞—Ö –±—É–¥–µ—Ç:

```
üßπ –ó–∞–ø—É—Å–∫ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏ –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π...
üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è ALGO/USDT @ 0.17: –≤–æ–∑—Ä–∞—Å—Ç 180.5—á > 168—á
üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –¥–∞–ª–µ–∫–æ –æ—Ç —Ü–µ–Ω—ã ALGO/USDT @ 0.19 (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ: 6.23%)
‚úÖ –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: —É–¥–∞–ª–µ–Ω–æ 15 –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç

- [x] –£–ª—É—á—à–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è cleanup_outdated_levels()
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –æ—Ç —Ü–µ–Ω—ã
- [x] –°–æ–∑–¥–∞–Ω—ã –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏
- [x] –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –∞–Ω–∞–ª–∏–∑–∞
- [x] –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç —É–¥–∞–ª–µ–Ω–∏—è
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑ (–≤—ã–ø–æ–ª–Ω–µ–Ω–æ)
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ (–æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏

---

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏:

- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ä–æ–≤–Ω–µ–π:** —Å 485 –¥–æ ~100-150 (–æ—Å—Ç–∞–Ω—É—Ç—Å—è —Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ)
- **–ö–∞—á–µ—Å—Ç–≤–æ —É—Ä–æ–≤–Ω–µ–π:** —Ç–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–∏ –±–ª–∏–∑–∫–æ –∫ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω–µ
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –±—ã—Å—Ç—Ä–µ–µ –∞–Ω–∞–ª–∏–∑ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
- **–¢–æ—á–Ω–æ—Å—Ç—å:** —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å—Ç–∞—Ä—ã–µ –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

